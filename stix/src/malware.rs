use serde::Deserialize;

use crate::{CommonProperties, TypedObject};

#[derive(Deserialize)]
pub struct Malware {
    #[serde(flatten)]
    base: CommonProperties,
    pub name: String,
    #[serde(default)]
    pub description: Option<String>,
}

impl Malware {
    pub fn name(&self) -> &str {
        &self.name
    }

    pub fn description(&self) -> Option<&str> {
        self.description.as_ref().map(|s| s.as_str())
    }
}

impl TypedObject for Malware {
    const TYPE: &'static str = "malware";
}

impl AsRef<CommonProperties> for Malware {
    fn as_ref(&self) -> &CommonProperties {
        &self.base
    }
}
